{% extends "base.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/farm_details.css' %}">
{% endblock %}
{% block title %}{{ farm.farm_name }}{% endblock %}

{% block content %}
<div class="farm-details-container">
    <!-- Left Section: Farm Info and Actions -->
    <div class="left-section">
        <div class="farm-logo">
            <img src="{% static 'images/logo.png' %}" alt="Farm Logo">
        </div>
        <div class="farm-details">
            <h1>{{ farm.farm_name }}</h1>
            <p>Location: {{ farm.location }}</p>
            <p>Total Land: {{ farm.total_area }} acres</p>
        </div>
        <div class="farm-actions">
            <a href="{% url 'edit_farm' farm.id %}" class="btn btn-edit">Edit Farm details</a>
            <a href="{% url 'farm_list' %}" class="btn btn-expert">Farms</a>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Logout</button>
            </form>
        </div>
    </div>

    <!-- Right Section: Weather, Soil, and Crops Info -->
    <div class="right-section">
        <!-- Current Weather Section -->
        <div class="info-box current-weather">
            <h2>Current Weather</h2>
            {% if weather_info %}
            <table class="weather-table">
                <thead>
                    <tr>
                        <th>Rainfall (mm)</th>
                        <th>Humidity (%)</th>
                        <th>Temperature (°C)</th>
                        <th>Wind Speed (m/s)</th>
                        <th>Wind Direction (°)</th>
                        <th>Cloudiness (%)</th>
                        <th>Feels Like (°C)</th>
                        <th>Temp Min (°C)</th>
                        <th>Temp Max (°C)</th>
                        <th>Pressure (hPa)</th>
                        <th>Sea Level (hPa)</th>
                        <th>Visibility (m)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ weather_info.rainfall }}</td>
                        <td>{{ weather_info.humidity }}</td>
                        <td>{{ weather_info.temperature }}</td>
                        <td>{{ weather_info.wind_speed }}</td>
                        <td>{{ weather_info.wind_direction }}</td>
                        <td>{{ weather_info.cloudiness }}</td>
                        <td>{{ weather_info.feels_like }}</td>
                        <td>{{ weather_info.temp_min }}</td>
                        <td>{{ weather_info.temp_max }}</td>
                        <td>{{ weather_info.pressure }}</td>
                        <td>{{ weather_info.sea_level }}</td>
                        <td>{{ weather_info.visibility }}</td>
                    </tr>
                </tbody>
            </table>
            {% else %}
                <p>No current weather data available.</p>
            {% endif %}
        </div>

        <!-- Weather History Section -->
        <div class="info-box weather-history">
            <h2>Weather History</h2>
            {% if weather_data %}
            <table class="weather-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Rainfall (mm)</th>
                        <th>Humidity (%)</th>
                        <th>Temperature (°C)</th>
                        <th>Wind Speed (m/s)</th>
                        <th>Wind Direction (°)</th>
                        <th>Cloudiness (%)</th>
                        <th>Feels Like (°C)</th>
                        <th>Temp Min (°C)</th>
                        <th>Temp Max (°C)</th>
                        <th>Pressure (hPa)</th>
                        <th>Sea Level (hPa)</th>
                        <th>Visibility (m)</th>
                        
                    </tr>
                </thead>
                <tbody>
                    {% for data in weather_data %}
                    <tr>
                        <td>{{ data.date }}</td>
                        <td>{{ data.rainfall }}</td>
                        <td>{{ data.humidity }}</td>
                        <td>{{ data.temperature }}</td>
                        <td>{{ data.wind_speed }}</td>
                        <td>{{ data.wind_direction }}</td>
                        <td>{{ data.cloudiness }}</td>
                        <td>{{ data.feels_like }}</td>
                        <td>{{ data.temp_min }}</td>
                        <td>{{ data.temp_max }}</td>
                        <td>{{ data.pressure }}</td>
                        <td>{{ data.sea_level }}</td>
                        <td>{{ data.visibility }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
                <p>No weather history data available.</p>
            {% endif %}
        </div>

        <!-- Soil and Recommended Crops Information -->
         <div class="soil-crop-info-section">
            <!-- Soil Information Section -->
            <div class="info-box soil-info">
                <h2>Soil Information</h2>
                {% if soil_info %}
                    <p>Soil Type: {{ soil_info.properties.soil_type|default:"Unknown" }}</p>
                    <p>pH Level: {{ soil_info.properties.ph_level|default:"N/A" }}</p>
                    <p>Nutrient Content: {{ soil_info.properties.nutrient_content|default:"Unknown" }}</p>
                {% else %}
                    <p>No soil data available.</p>
                {% endif %}
            </div>

            <div class="info-box recommended-crops">
                <h2>Recommended Crops</h2>
                <ul>
                    {% for crop in recommendations %}
                        <li>{{ crop }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
<pre>{{ soil_info | safe }}</pre>
{% endblock %}
