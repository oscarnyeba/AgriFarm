{% extends "base.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/farm_details.css' %}">
{% endblock %}
{% block title %}{{ farm.farm_name }}{% endblock %}

{% block content %}
<div class="farm-details-container">
    <!-- Left Section: Farm Info and Actions -->
    <div class="left-section">
        <div class="farm-logo">
            <img src="{% static 'images/logo.png' %}" alt="Farm Logo">
        </div>
        <div class="farm-details">
            <h1>{{ farm.farm_name }}</h1>
            <p>Location: {{ farm.location }}</p>
            <p>Total Land: {{ farm.total_area }} acres</p>
        </div>
        <div class="farm-actions">
            <a href="{% url 'edit_farm' farm.id %}" class="btn btn-edit">Edit Farm details</a>
            <a href="{% url 'farm_list' %}" class="btn btn-expert">Farms</a>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Logout</button>
            </form>
        </div>
    </div>

    <!-- Right Section: Weather, Soil, and Crops Info -->
    <div class="right-section">
        <section id="current-weather">
            <h2>Current Weather in {{ weather_info.name }}</h2>
            {% if weather_info %}
                <div class="weather-overview">
                    <img src="http://openweathermap.org/img/wn/{{ weather_info.weather.0.icon }}@2x.png" alt="{{ weather_info.weather.0.description }}">
                    <h3>{{ weather_info.weather.0.main }} ({{ weather_info.weather.0.description }})</h3>
                    <p>Temperature: {{ weather_info.main.temp }}°C</p>
                    <p>Feels like: {{ weather_info.main.feels_like }}°C</p>
                </div>
                
                <div class="weather-details">
                    <h3>Details</h3>
                    <p>Min Temperature: {{ weather_info.main.temp_min }}°C</p>
                    <p>Max Temperature: {{ weather_info.main.temp_max }}°C</p>
                    <p>Pressure: {{ weather_info.main.pressure }} hPa</p>
                    <p>Humidity: {{ weather_info.main.humidity }}%</p>
                    <p>Sea Level Pressure: {{ weather_info.main.sea_level }} hPa</p>
                    <p>Ground Level Pressure: {{ weather_info.main.grnd_level }} hPa</p>
                    <p>Visibility: {{ weather_info.visibility }} meters</p>
                </div>
                
                <div class="wind-info">
                    <h3>Wind</h3>
                    <p>Speed: {{ weather_info.wind.speed }} m/s</p>
                    <p>Direction: {{ weather_info.wind.deg }}°</p>
                    <p>Gust: {{ weather_info.wind.gust }} m/s</p>
                </div>
                
                <div class="cloud-info">
                    <h3>Clouds</h3>
                    <p>Cloudiness: {{ weather_info.clouds.all }}%</p>
                </div>
                
                <div class="sun-info">
                    <h3>Sun</h3>
                    <p>Sunrise: {{ weather_info.sys.sunrise|date:"H:i" }}</p>
                    <p>Sunset: {{ weather_info.sys.sunset|date:"H:i" }}</p>
                </div>
                
                <div class="location-info">
                    <h3>Location</h3>
                    <p>Coordinates: {{ weather_info.coord.lat }}, {{ weather_info.coord.lon }}</p>
                    <p>Country: {{ weather_info.sys.country }}</p>
                </div>
                
                <p>Last updated: {{ weather_info.dt|date:"F d, Y H:i:s" }}</p>
            {% else %}
                <p>No current weather data available.</p>
            {% endif %}
        </section>        
        
        <div class="info-box recommended-crops">
            <h2>Recommended Crops</h2>
            {% if recommendations %}
                <ul>
                    {% for crop in recommendations %}
                        <li>
                            <strong>{{ crop.name }}</strong>
                            <p>Predicted Yield: {{ crop.predicted_yield }} units/acre</p>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No crop recommendations available at the moment.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
